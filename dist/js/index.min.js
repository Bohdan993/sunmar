(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var e=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers=[]}var n,a;return n=e,(a=[{key:"subscribe",value:function(t){this.observers.push(t)}},{key:"unsubscribe",value:function(t){this.observers=this.observers.filter((function(e){return e!==t}))}},{key:"broadcast",value:function(t){this.observers.forEach((function(e){return e(t)}))}}])&&t(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),e}(),n=(document.querySelector("body"),document.querySelector(".table-calc__btn")),a=document.querySelector(".table-calc"),o=document.querySelector("#catalog-content .ajax_load.cur.block"),r=document.querySelectorAll(".table-calc input"),i={init:function(){this.ii()},ii:function(){!function(t,n,a,o){var r=t.querySelector(".table-calc__total .total"),i={total:0,inputs:{}},c=new e;c.subscribe((function(t){0===i.total?r.innerText=0:r.innerText=(t/1e3).toFixed(2)+"кВт ("+(t/1e3/.8).toFixed(1)+"кВа)"})),t.addEventListener("change",(function(t){var e=t.target;if("INPUT"==e.tagName){var n=e.dataset.power,a=e.value,o=e.dataset.id;if(o in i.inputs){var r=i.inputs[o],u=+a*+n;i.inputs[o]=u,i.total=i.total-r+u,c.broadcast(i.total)}else{var l=+a*+n;i.inputs[o]=l,i.total+=l,c.broadcast(i.total),console.log(i.total)}}})),t.addEventListener("input",(function(t){var e=t.target;if("INPUT"==e.tagName){var n=e.value;e.value=n.replace(/\D/g,"")}})),n.addEventListener("click",(function(t){var e,n,o,r,c;0!==i.total?(e=(i.total/1e3).toFixed(2),n=a,o=this,r=Math.ceil(Number(e)).toFixed(0),c=String(r).length,fetch("https://agent-energy.com.ua/calculator/ajax.php/?AJAX_GET=Y&GLOBAL_FILTER=a%3A4%3A%7Bs%3A6%3A%22ACTIVE%22%3Bs%3A1%3A%22Y%22%3Bs%3A9%3A%22IBLOCK_ID%22%3Bs%3A2%3A%2226%22%3Bs%3A14%3A%22%3E%3DPROPERTY_665%22%3Bs%3A".concat(c,"%3A%22").concat(r,"%22%3Bs%3A10%3A%22SECTION_ID%22%3Ba%3A3%3A%7Bi%3A0%3Bi%3A156%3Bi%3A1%3Bi%3A155%3Bi%3A2%3Bi%3A154%3B%7D%7D"),{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){return t.text()})).then((function(t){n.innerHTML=t,o.remove()})).catch((function(t){return console.error(t)}))):alert("Відсутні введені дані")})),o.forEach((function(t){t.disabled=!1,t.value=0}))}(a,n,o,r)}};"loading"!==document.readyState?i.init():document.addEventListener("DOMContentLoaded",(function(){i.init()}))})();